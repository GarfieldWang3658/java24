CREATE TABLE CLASS
(classid INT PRIMARY KEY,
subject VARCHAR(32) NOT NULL DEFAULT '',
deptname VARCHAR(32) ,
enrolltime INT NOT NULL DEFAULT(2000) ,
num INT NOT NULL DEFAULT(0),
FOREIGN KEY (deptname) REFERENCES DEPARTMENT(deptname)
);

DROP TABLE CLASS
DROP TABLE DEPARTMENT
SELECT*FROM student
CREATE TABLE STUDENT
(studentid INT PRIMARY KEY,
`name` VARCHAR(32) NOT NULL DEFAULT ' ',
age INT NOT NULL DEFAULT(0),
classid INT,
FOREIGN KEY (classid) REFERENCES CLASS(classid)
);

CREATE TABLE DEPARTMENT(
departmentid VARCHAR(32) PRIMARY KEY,
deptname VARCHAR(32) UNIQUE NOT NULL
);

INSERT INTO CLASS
VALUES
(101,'软件','计算机',1995,20);

INSERT INTO CLASS
VALUES
(102,'微电子','计算机',1996,30);

INSERT INTO CLASS
VALUES
(111,'无机化学','化学',1995,29);

INSERT INTO CLASS
VALUES
(112,'高分子化学','数学',1996,25);

INSERT INTO CLASS
VALUES
(121,'统计数学','中文',1995,20);

INSERT INTO CLASS
VALUES
(131,'现代语言','计算机',1996,20);

INSERT INTO CLASS
VALUES
(141,'国际贸易','经济',1997,30);

INSERT INTO CLASS
VALUES
(142,'国际金融','经济',1996,14);

INSERT INTO DEPARTMENT
VALUES
(001,'数学');
INSERT INTO DEPARTMENT
VALUES
(002,'计算机');
INSERT INTO DEPARTMENT
VALUES
(003,'化学');
INSERT INTO DEPARTMENT
VALUES
(004,'中文');
INSERT INTO DEPARTMENT
VALUES(005,'经济');

INSERT INTO STUDENT VALUES(8101,'张三',18,101);
INSERT INTO student VALUES(8102,'钱四',18,121);
INSERT INTO student VALUES(8103,'王玲',18,131);
INSERT INTO student VALUES(8105,'李飞',18,102);
INSERT INTO student VALUES(8109,'赵四',18,141);
INSERT INTO student VALUES(8110,'李可',18,142);
INSERT INTO student VALUES(8201,'张飞',18,111);
INSERT INTO student VALUES(8302,'周瑜',18,112);
INSERT INTO student VALUES(8203,'王亮',18,111);
INSERT INTO student VALUES(8305,'董卿',18,102);
INSERT INTO student VALUES(8409,'赵龙',18,101);



SELECT `name`
FROM student
WHERE name LIKE'%李%';

SELECT deptname,COUNT(*) AS c
FROM class
GROUP BY deptname HAVING c>1

SELECT class.deptname,SUM(num) AS c,departmentid
FROM class,DEPARTMENT
WHERE class.deptname=DEPARTMENT.deptname
GROUP BY deptname HAVING c>= 30;

SELECT tmp.*,DEPARTMENT.departmentid
FROM DEPARTMENT,(
SELECT deptname,SUM(num) AS c
FROM class
GROUP BY deptname HAVING c>= 30)tmp
WHERE tmp.deptname=DEPARTMENT.deptname;

INSERT INTO DEPARTMENT
VALUES(006,'物理');

DELETE FROM student

START TRANSACTION
UPDATE class SET num = num-1
WHERE classid = (SELECT classid FROM student WHERE NAME = '张三');


DELETE FROM student
WHERE name = '张三';

COMMIT

SELECT*FROM student
SELECT*FROM class